<div class="max-w-2xl mx-auto px-6 py-16">
  <div class="text-center mb-12">
    <span class="inline-block px-3 py-1 bg-blue-50 text-blue-600 text-xs font-black rounded-full uppercase tracking-widest mb-4">Registration</span>
    <h1 class="text-4xl font-black text-gray-900 tracking-tighter mb-2"><%= @edition.race.title %></h1>
    <p class="text-xl font-bold text-gray-500"><%= @edition.name %></p>
  </div>

  <div class="bg-white rounded-[2.5rem] shadow-xl shadow-gray-200 border border-gray-100 p-8 md:p-12 overflow-hidden relative">
    <!-- Decorative Circle -->
    <div class="absolute -top-12 -right-12 w-48 h-48 bg-blue-50 rounded-full blur-3xl opacity-50 pointer-events-none"></div>

    <%= form_with(model: @registration, url: registrations_path, local: true, class: "space-y-8 relative z-10") do |f| %>
      <%= f.hidden_field :race_edition_id, value: @edition.id %>
      
      <!-- Participant Info -->
      <section>
        <h3 class="text-lg font-black text-gray-900 mb-6 flex items-center">
          <span class="w-8 h-8 rounded-full bg-gray-900 text-white flex items-center justify-center mr-3 text-sm font-bold shadow-lg shadow-gray-200">1</span>
          참가자 정보
        </h3>
        <div class="space-y-4">
           <div>
             <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Name</label>
             <input type="text" value="<%= current_user.name %>" disabled class="w-full px-5 py-4 rounded-2xl bg-gray-50 border-transparent text-gray-500 font-bold focus:ring-0">
           </div>
           <div>
             <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Phone</label>
             <input type="text" value="<%= current_user.phone_number %>" disabled class="w-full px-5 py-4 rounded-2xl bg-gray-50 border-transparent text-gray-500 font-bold focus:ring-0">
           </div>
        </div>
      </section>

      <!-- Additional Info -->
      <section class="pt-8 border-t border-gray-100">
        <h3 class="text-lg font-black text-gray-900 mb-6 flex items-center">
          <span class="w-8 h-8 rounded-full bg-gray-900 text-white flex items-center justify-center mr-3 text-sm font-bold shadow-lg shadow-gray-200">2</span>
          추가 정보
        </h3>
        
        <div class="space-y-6">
          <div>
            <%= f.label :tshirt_size, "기념품 티셔츠 사이즈", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
            <%= f.select :tshirt_size, ['S (90)', 'M (95)', 'L (100)', 'XL (105)', 'XXL (110)'], { prompt: "사이즈 선택" }, class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all appearance-none bg-white font-medium text-gray-900" %>
          </div>
          
          <div>
            <%= f.label :emergency_contact, "비상 연락처", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
            <%= f.text_field :emergency_contact, placeholder: "가족 또는 지인 연락처", class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all font-medium text-gray-900" %>
          </div>
          
          <div>
             <label class="block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2">크루 코드 (선택)</label>
             <input type="text" name="crew_code" placeholder="크루장에게 받은 코드 입력" class="w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all uppercase font-medium text-gray-900">
             <p class="text-xs text-blue-500 mt-2 font-bold flex items-center">
               <svg class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
               크루 코드를 입력하면 단체 할인이 적용될 수 있습니다.
             </p>
          </div>
        </div>
      </section>

      <!-- Shipping Address -->
      <section class="pt-8 border-t border-gray-100">
        <h3 class="text-lg font-black text-gray-900 mb-6 flex items-center">
          <span class="w-8 h-8 rounded-full bg-gray-900 text-white flex items-center justify-center mr-3 text-sm font-bold shadow-lg shadow-gray-200">3</span>
          배송지 정보
        </h3>
        
        <div class="bg-blue-50 border border-blue-100 rounded-2xl p-4 mb-6">
          <div class="flex items-start">
            <svg class="w-5 h-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p class="text-xs text-blue-700 font-bold">
              등번호와 기념품(티셔츠, 메달 등)을 받으실 주소를 입력해주세요.
            </p>
          </div>
        </div>
        
        <div class="space-y-4" data-controller="postal-code">
          <div class="grid grid-cols-3 gap-4">
            <div>
              <%= f.label :shipping_zipcode, "우편번호", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
              <%= f.text_field :shipping_zipcode, value: current_user.address_zipcode, placeholder: "12345", data: { postal_code_target: "zipcode" }, class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all font-medium text-gray-900" %>
            </div>
            <div class="col-span-2 flex items-end">
              <button type="button" data-action="click->postal-code#search" class="w-full py-4 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold rounded-2xl transition-all">
                우편번호 찾기
              </button>
            </div>
          </div>

          <div>
            <%= f.label :shipping_address, "기본 주소", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
            <%= f.text_field :shipping_address, value: current_user.address_basic, placeholder: "서울시 강남구 테헤란로 123", data: { postal_code_target: "address" }, class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all font-medium text-gray-900" %>
          </div>
          
          <div>
            <%= f.label :shipping_address_detail, "상세 주소", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
            <%= f.text_field :shipping_address_detail, value: current_user.address_detail, placeholder: "4층 401호", class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all font-medium text-gray-900" %>
          </div>
          
          <div>
            <%= f.label :shipping_phone, "수령인 연락처", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
            <%= f.text_field :shipping_phone, value: current_user.phone_number, placeholder: "010-1234-5678", class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all font-medium text-gray-900" %>
          </div>
          
          <div>
            <%= f.label :shipping_memo, "배송 메모 (선택)", class: "block text-xs font-bold text-gray-700 uppercase tracking-widest mb-2" %>
            <%= f.text_area :shipping_memo, rows: 2, placeholder: "예: 부재 시 경비실에 맡겨주세요", class: "w-full px-5 py-4 rounded-2xl border-gray-200 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all font-medium text-gray-900 resize-none" %>
          </div>
        </div>
      </section>

      <!-- Payment Summary -->
      <section class="pt-8 border-t border-gray-100 bg-gray-50 -mx-8 -mb-12 md:-mx-12 md:-mb-12 p-8 md:p-12 rounded-b-[2.5rem]">
        <div class="flex justify-between items-center mb-8">
          <span class="font-bold text-gray-500 uppercase tracking-widest text-xs">Total Payment</span>
          <span class="text-3xl font-black text-gray-900 tracking-tight"><%= number_to_currency(@edition.price, unit: "₩", precision: 0) %></span>
        </div>
        
        <%= f.submit "결제하기", class: "w-full py-5 bg-blue-600 hover:bg-blue-700 text-white font-black rounded-2xl shadow-xl shadow-blue-200 transition-all active:scale-[0.98] text-lg uppercase tracking-widest cursor-pointer" %>
        
        <div class="mt-6 flex items-center justify-center space-x-2 opacity-50 grayscale hover:grayscale-0 transition-all">
           <!-- Payment Icons (Placeholders) -->
           <div class="h-6 w-10 bg-gray-200 rounded"></div>
           <div class="h-6 w-10 bg-gray-200 rounded"></div>
           <div class="h-6 w-10 bg-gray-200 rounded"></div>
        </div>
        <p class="text-center text-[10px] text-gray-400 font-bold mt-2 uppercase tracking-widest">
          Secure Payment by Portone
        </p>
      </section>
    <% end %>
  </div>
</div>
